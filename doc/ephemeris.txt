*ephemeris.txt*	a diary plugin for vim
HP4k1h5 <robertwalks@gmail.com>                                    *ephemeris*

==============================================================================
CONTENTS                                                  *ephemeris-contents*
  1. Introduction............................................|ephemeris-intro|
  2. Configuration..........................................|ephemeris-config|
  3. Commands.............................................|ephemeris-commands|
  4. Functions...........................................|ephemeris-functions|

==============================================================================
INTRODUCTION                                                 *ephemeris-intro*

ephemeris is a diary and calendar extension plugin for vim. It provides a
collection of functions and commands that can be used to create, edit, and
curate diary/log entries.

The diary is defined by the directories and files found recursively under the
directory set in the global variable |g:ephemeris_diary|. ephemeris does not
rely on any external programs and does not interfere with any external
program, such as cal, etc. This plugin works best when the directory structure
of |g:ephemeris_diary| is YYYY/MM/DD.md, as follows:
>
  ├── 2019
  │   └── 09
  │       ├── 16.md
  │   └── 12
  │       └── 20.md
  ├── 2020
  │   └── 05
  │       ├── 01.md
  │       ├── 04.md
<
This tree structure is provided by default by ephemeris functions. This plugin
will only provide limited functionality if the directory structure does not
include a date-aligned directory structure as outlined above.

HELP
          see 'README.md' and 'doc/ephemeris.txt'

THANKS
          mattn <https://github.com/mattn/calendar-vim>
for a great plugin and the inspiration to make some helper functions

          junegunn <https://github.com/junegunn/vader.vim
for the testing suite


==============================================================================
CONFIGURATION                                               *ephemeris-config*

                                                           *g:ephemeris_diary*
Directory path for diary. All functions that rely on this variable/directory
are dependent on it having the following directory structure:
>
    ├── 2019
    │   └── 09
    │       ├── 16.md
    │   └── 12
    │       └── 20.md
    ├── 2020
    │   └── 05
    │       ├── 01.md
    │       ├── 04.md
<
files that do not conform to the `g:ephemeris_diary/YYYY/MM/DD.md` format,
will not be available to date reliant functions such as
|ephemeris#lst#copy_todos()|

Default: { No default! } must be set by user

Example: `:let g:ephemeris_diary = '~/diary'`

                                                           *g:ephemeris_todos*
marker to indicate the beginning of the list of task items to be copied over
to current day's diary entry. see |ephemeris#lst#copy_todos()|. Also serves as
a delimiter for |ephemeris#lst#filter_tasks()|

Default: TODOs

Example: `:let g:ephemeris_todos = '===TASK LIST==='`

                                                    *g:ephemeris_toggle_block*
Accepts a boolean. If true, the user can toggle tasks from anywhere inside a
task block.

Default: 1

Example: `:let g:ephemeris_toggle_block = 1`
||||||| 9c93f5f
Example:  :let g:ephemeris_diary = '~/diary'
=======
Example: `:let g:ephemeris_todos = '===TASK LIST==='`

                                                    *g:ephemeris_toggle_block*
Accepts a boolean. If true, the user can toggle tasks from anywhere inside a
task block.

Default: 0

Example: `:let g:ephemeris_toggle_block = 1`
>>>>>>> 96f3653c354dd8952887fe63001ab7e8394134d0

==============================================================================
COMMANDS                                                  *ephemeris-commands*

:EphemerisCreateIndex                                  *:EphemerisCreateIndex*
  Create markdown diary index of all '.md' files found under the
  |g:ephemeris_diary| directory, and go to vertical split.  Calls
  |ephemeris#ind#create_index()|

:EphemerisGotoIndex                                      *:EphemerisGotoIndex*
  Open diary index in a vertical split or focus diary index buffer. Index is
  found at |g:ephemeris_diary|/index.md. Calls |ephemeris#ind#goto_index()|

:EphemerisCopyTodos                                      *:EphemerisCopyTodos*
<<<<<<< HEAD
  Copy TODOs from last set of TODOs going back up to 10 years. Your
  |g:ephemeris_diary| directory must  be organized in a `.../YYYY/MM/DD.md`
  hierarchy, in order for this function to know which set of TODOs are _most
  recent_. TODOs are defined by the string set in |g:ephemeris_todos|. Default
  is 'TODOs'. Everything below that marker, until 2 consecutive newlines, an
  incomplete task, or a subsequent g:ephemeris_todos marker, is copied to the
  current day's diary entry. It will open today's diary entry in a split.
  Calls |ephemeris#lst#copy_todos()|
||||||| 9c93f5f
  Look backwards through previous entries for last |g:ephemeris_todos| marker,
  as defined by the tasks found below the string.  Calls
  |ephemeris#lst#copy_todos()|
=======
  Copy TODOs from last set of TODOs going back up to 10 years. Your
  |g:ephemeris_diary| directory must  be organized in a `.../YYYY/MM/DD.md`
  hierarchy, in order for this function to know which set of TODOs are _most
  recent_. TODOs are defined by the string set in |g:ephemeris_todos|. Default
  is 'TODOs'. **Everything** below that marker is copied to the current day's
  diary entry. It will open today's diary entry in a split. Calls
  |ephemeris#lst#copy_todos()|
>>>>>>> 96f3653c354dd8952887fe63001ab7e8394134d0

:EphemerisFilterTasks [archive] [summary]              *:EphemerisFilterTasks*
  Delete completed tasks, e.g. list items containing `- [x]`, and all
  associated subblocks until the next incomplete task, e.g. list items
  containing `- [ ]`, a |g:ephemeris_todos| marker, 2 newlines, or EOF. See
  example in |ephemeris#lst#filter_tasks()|. The first argument [archive] is a
  boolean which determines whether the filtered tasks are moved to
  'g:ephemeris_diary'/.cache/archive.md. Default is 0. The second argument
  [summary] is a boolean. If true this function will print a summary of
  filtered/remaining tasks at the bottom of the buffer. Default is 0.

:EphemerisToggleTask                                    *:EphemerisToggleTask*
  Toggles the state of a task between
>
    - [ ] incomplete
      and
    - [x] complete
<
  when the cursor is on a line containing a task. Calls
  |ephemeris#lst#toggle_task()|. If |g:ephemeris_toggle_block| is true,
  activating the command will affect parent task items.

==============================================================================
FUNCTIONS                                                *ephemeris-functions*

ephemeris#fs#create_fp({filepath})                  *ephemeris#fs#create_fp()*
  Creates a dirpath and/or file at the expanded {filepath}. If the filepath
  ends in a '/', only the dirpath is created. Can be used idempotently.

ephemeris#fs#get_set_date({date})                *ephemeris#fs#get_set_date()*
  Creates a diary entry buffer for {date} and, if necessary, the intermediate
  `g:ephemeris_diary/YYYY/MM/...` directory path. Date must be in YYYY/MM/DD
  format in order to work with other ephemeris functions. If {date} is 0, it
  will return today's date. See |g:ephemeris_diary|

  Returns a string containing the date's diary entry filepath

ephemeris#ind#goto_index({dir})                   *ephemeris#ind#goto_index()*
  Find or create, and go to diary index file. {dir} is the directory path of
  the diary whose index you wish to access. This is typically the same path as
  'g:ephemeris_diary'. ephemeris index located at 'g:ephemeris_diary'/index.md

  Returns 0

ephemeris#ind#create_index()                    *ephemeris#ind#create_index()*
  Create an index of diary entries found recursively under the
  |g:ephemeris_diary| directory at `g:ephemeris_diary/index.md`, and open the
  index in a vertical split. Entries are formatted as markdown links.

ephemeris#lst#find_task()                          *ephemeris#lst#find_task()*

  will find the nearest associated task looking back up the buffer

  Returns the line number of the associated task or -1 if no such task is
  found

ephemeris#lst#copy_todos()                        *ephemeris#lst#copy_todos()*
  Copy TODOs from last set of TODOs going back up to 10 years. Your
  |g:ephemeris_diary| directory must  be organized in a `.../YYYY/MM/DD.md`
  hierarchy, in order for this function to know which set of TODOs are _most
  recent_. TODOs are defined by the string set in |g:ephemeris_todos|. Default
  is 'TODOs'. **Everything** below that marker is copied to the current day's
  diary entry. It will open today's diary entry in a split. This function can
  be called from anywhere.

ephemeris#lst#filter_tasks()                    *ephemeris#lst#filter_tasks()*
  Filter out completed tasks and their associated blocks in the current
  buffer. i.e., if you have a set of tasks like,
>
    - [ ] ephemeris docs
      -[x] `.md`
        - more list items but not tasks
          and a nested block of text
          with a few lines
      -[ ] `txt`
        more text
        up to two blank lines


        - and more items etc.
    - [x] export autocommands
<
  and you run `:EphemerisFilterTasks` in the command-line mode, you will be
  left with
>
    - [ ] ephemeris docs
      -[ ] `txt`
        more text
        up to two blank lines


        - and more items etc.
<
  If [a:1], the first parameter passed to this function, is not false,
  filtered tasks will be moved to 'g:ephemeris_diary'/.cache/archive.md. If
  [a:2], the second parameter, is not false, a task summary will be printed a
  the bottom of the current buffer. This summary will not be copied over by
  EphemerisCopyTodos

ephemeris#lst#toggle_task()                      *ephemeris#lst#toggle_task()*
  Toggle state of task on the line under the cursor between
>
    - [ ] incomplete, and
    - [x] complete
<
  if 'g:ephemeris_toggle_block' is true, the function will toggle the parent
  task of the current block.

  Returns 0

ephemeris#var#get_g_diary()                      *ephemeris#var#get_g_diary()*
  helper function to get/set state of |g:ephemeris_diary|. If
  g:ephemeris_diary is not found an error is thrown. errors should be handled
  by calling functions

  Returns a string containing the expanded g:ephemeris_diary directory path

ephemeris#var#get_set_g_todos()              *ephemeris#var#get_set_g_todos()*
  helper function to get/set state of 'g:ephemeris_todos'

  Returns a string of the marker

ephemeris#var#get_g_toggle_block()        *ephemeris#var#get_g_toggle_block()*
  helper function to get state of |g:ephemeris_toggle_block|

  Returns a boolean indicating whether blocks can toggle parent tasks


vim:tw=78:ts=8:ft=help:norl:
